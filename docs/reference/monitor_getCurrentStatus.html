<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get current status of monitors — monitor_getCurrentStatus • PWFSLSmoke</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Get current status of monitors — monitor_getCurrentStatus" />
<meta property="og:description" content="This function augments the metadata from a ws_monitor
object with summarized and aggregate data from the ws_monitor object." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PWFSLSmoke</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.109</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/PWFSLSmoke.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Data_Model.html">Data Model</a>
    </li>
    <li>
      <a href="../articles/Example_Save_Data_as_CSV.html">Example: Save Data as CSV</a>
    </li>
    <li>
      <a href="../articles/Maps_and_Timeseries_Plots.html">Maps and Timeseries Plots</a>
    </li>
    <li>
      <a href="../articles/NowCast.html">NowCast</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/MazamaScience/PWFSLSmoke">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get current status of monitors</h1>
    <small class="dont-index">Source: <a href='https://github.com/MazamaScience/PWFSLSmoke/blob/master/R/monitor_getCurrentStatus.R'><code>R/monitor_getCurrentStatus.R</code></a></small>
    <div class="hidden name"><code>monitor_getCurrentStatus.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function augments the metadata from a <em>ws_monitor</em>
object with summarized and aggregate data from the <em>ws_monitor</em> object.</p>
    </div>

    <pre class="usage"><span class='fu'>monitor_getCurrentStatus</span>(
  <span class='no'>ws_monitor</span>,
  <span class='kw'>endTime</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>monitorURLBase</span> <span class='kw'>=</span> <span class='st'>"http://tools.airfire.org/monitoring/v4/#!/?monitors="</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ws_monitor</th>
      <td><p><em>ws_monitor</em> object.</p></td>
    </tr>
    <tr>
      <th>endTime</th>
      <td><p>Time to which the status of the monitors will be current. By
default, it is the most recent time in <code>ws_monitor</code>. This time can be
given as a POSIXct time, or a string/numeric value in ymd format (eg.
20190301). This time converted to UTC.</p></td>
    </tr>
    <tr>
      <th>monitorURLBase</th>
      <td><p>A URL prefix pointing to where more information about a
monitor can be found. By default, it points to the AirFire monitoring site.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A table containing the current status information for all the
  monitors in <em>ws_monitor</em>.</p>
    <h2 class="hasAnchor" id="-last-and-previous-"><a class="anchor" href="#-last-and-previous-"></a>"Last" and "Previous"</h2>

    

<p>The goal of this function is to provide useful information about what
happened recently with each monitor in the provided <em>ws_monitor</em> object.
Monitors sometimes don't consistently report data, however, and it's not
useful to have <code>NA</code>'s reported when there is still valid data at other
times. To address this, <code>monitor_getCurrentStatus</code> uses <em>last</em> and
<em>previous</em> valid times. These are the time when a monitor most recently
reported data, and the most recent time of valid data before that,
respectively. By reporting on these times, the function ensures that valid
data is returned and provides information on how outdated this information
is.</p>
    <h2 class="hasAnchor" id="calculating-latency"><a class="anchor" href="#calculating-latency"></a>Calculating latency</h2>

    

<p>According to https://docs.airnowapi.org/docs/HourlyDataFactSheet.pdf
a datum assigned to 2pm represents the average of data between 2pm and 3pm.
So, if we check at 3:15pm and see that we have a value for 2pm but not 3pm
then the data are completely up-to-date with zero latency.</p>
<p><code>monitor_getCurrentStatus()</code> defines latency as the difference in time
between the given time index and the next most recent time index. If there is
no more recent time index, then the difference is measured to the given
<code>endTime</code> parameter. These differences are recorded in hours.</p>
<p>For example, if the recorded values for a monitor are
<code>[16.2, 15.8, 16.4, NA, 14.0, 12.5, NA, NA, 13.3, NA]</code>, then the last
valid time index is 9, and the previous valid time index is 6. The last
latency is then 1 (hour), and the previous latency is 3 (hours).</p>
    <h2 class="hasAnchor" id="summary-data"><a class="anchor" href="#summary-data"></a>Summary data</h2>

    

<p>The table created by <code>monitor_getCurrentStatus()</code> includes summary
information for the data part of the given <em>ws_monitor</em> object. The
summaries included are listed below with a description:</p>
<dl class='dl-horizontal'>
  <dt>yesterday_pm25_24hr</dt><dd><p>Daily AQI value for the day prior to <code>endTime</code></p></dd>
  <dt>last_nowcast_1hr</dt><dd><p>Last valid NowCast measurement</p></dd>
  <dt>last_PM2.5_1hr</dt><dd><p>Last valid raw PM2.5 measurement</p></dd>
  <dt>last_PM2.5_3hr</dt><dd><p>Mean of the last valid raw PM2.5 measurementwith the preceding two measurements</p></dd>
  <dt>previous_nowcast_1hr</dt><dd><p>Previous valid NowCast measurement</p></dd>
  <dt>previous_PM2.5_1hr</dt><dd><p>Previous valid raw PM2.5 measurement</p></dd>
  <dt>previous_PM2.5_3hr</dt><dd><p>Mean of the previous valid raw PM2.5 measurement with the preceding two measurements</p></dd>

</dl>

<p>It should be noted that all averages are "right-aligned", meaning that the
three hour mean of data at time <code>n</code> will comprise of the data at times
<code>[n-2, n-1, n]</code>. Data for <code>n-2</code> and <code>n-1</code> is not guaranteed to
exist, so a three hour average may include 1 to 3 data points.</p>
    <h2 class="hasAnchor" id="event-flags"><a class="anchor" href="#event-flags"></a>Event flags</h2>

    

<p>The table created by <code>monitor_getCurrentStatus()</code> also includes binary
flags representing events that may have occurred for a monitor within the
bounds of the specified end time and data in the <em>ws_monitor</em> object.
Each flag is listed below with its corresponding meaning:</p>
<dl class='dl-horizontal'>
  <dt>last_nowcastLevel</dt><dd><p>NowCast level at the last valid time</p></dd>
  <dt>previous_nowcastLevel</dt><dd><p>NowCast level at the previous valid time</p></dd>
  <dt>NR6</dt><dd><p>Monitor not reporting for more than 6 hours</p></dd>
  <dt>NEW6</dt><dd><p>New monitor reporting in the last 6 hours</p></dd>
  <dt>USG6</dt><dd><p>NowCast level increased to Unhealthy for Sensitive Groups in the last 6 hours</p></dd>
  <dt>U6</dt><dd><p>NowCast level increased to Unhealthy in the last 6 hours</p></dd>
  <dt>VU6</dt><dd><p>NowCast level increased to Very Unhealthy in the last 6 hours</p></dd>
  <dt>HAZ6</dt><dd><p>NowCast level increased to Hazardous in the last 6 hours</p></dd>
  <dt>MOD6</dt><dd><p>NowCast level decreased to Moderate or Good in the last 6 hours</p></dd>
  <dt>MAL6</dt><dd><p>Monitor malfunctioning the last 6 hours (not currently implemented)</p></dd>

</dl>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>ws_monitor</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='monitor_loadLatest.html'>monitor_loadLatest</a></span>() <span class='kw'>%&gt;%</span> <span class='fu'><a href='monitor_subset.html'>monitor_subset</a></span>(<span class='kw'>stateCodes</span> <span class='kw'>=</span> <span class='st'>"WA"</span>)
<span class='no'>statusTbl</span> <span class='kw'>&lt;-</span> <span class='fu'>monitor_getCurrentStatus</span>(<span class='no'>ws_monitor</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#-last-and-previous-">"Last" and "Previous"</a></li>
      <li><a href="#calculating-latency">Calculating latency</a></li>
      <li><a href="#summary-data">Summary data</a></li>
      <li><a href="#event-flags">Event flags</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jonathan Callahan, Hans Martin, Spencer Pease, Helen Miller, Rohan Aras, Zach Dingels, Jon Hagg, Jimin Kim, Rex Thompson, Alice Yang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


