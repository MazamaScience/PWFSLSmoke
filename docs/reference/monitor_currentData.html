<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a dataframe of current monitor data — monitor_currentData • PWFSLSmoke</title>

<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Create a dataframe of current monitor data — monitor_currentData" />

<meta property="og:description" content="Extracts current status data from a ws_monitor object. In addition to monitor metadata, the returned data include the following:
monitorID - the PWFSL monitor ID
lastValidTime - UTC POSIXct time corresponding to the last valid pm25 datum
lastValidLocalTimestamp - ASCII version of lastValidTime in monitor-local timezone
processingTime - UTC POSIXct when the function is run (i.e. 'now')
datetime - UTC POSIXct of the datetime that the data represents. See datetime parameter. In most instances, the same as processingTime
latency - (difference between processingTime -1 hr) and lastValidTime, floored to the hour
lastValid_PM2.5_nowcast - NowCast value at lastValidTime
lastValid_PM2.5_1hr - PM2.5 value at lastValidTime (should never be null)
lastValid_PM2.5_3hr - mean of the three hours preceeding lastValidTime
yesterday_PM2.5_24hr - local time midnight-to-midnight 24-hour mean for the day prior to processingTime
monitoringSiteUrl - URL to PWFSL Monitoring v4 site, initialized with a specific monitor
The three-hour average will remove missing values and may represent an average of 1-3 hours.
The yesterday average will remove up to six missing values, returning NA if more than six hours of yesterday's data are missing.
Any monitors with no data from before the desired datetime will be excluded.
NOTE: yesterday_PM2.5_24hr represents yesterday relative to datetime -- i.e. actually yesterday.
The various 'lastValid' values describe the most recent valid values -- before datetime, whenever they occurred." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PWFSLSmoke</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Data_Model.html">Data Model</a>
    </li>
    <li>
      <a href="../articles/Maps_and_Timeseries_Plots.html">Maps and Timeseries Plots</a>
    </li>
    <li>
      <a href="../articles/NowCast.html">NowCast</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/MazamaScience/PWFSLSmoke">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a dataframe of current monitor data</h1>
    <small class="dont-index">Source: <a href='https://github.com/MazamaScience/PWFSLSmoke/blob/master/R/monitor_currentData.R'><code>R/monitor_currentData.R</code></a></small>
    <div class="hidden name"><code>monitor_currentData.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Extracts current status data from a ws_monitor object. In addition to monitor metadata, the returned data include the following:</p><ul>
<li><p><code>monitorID</code> - the PWFSL monitor ID</p></li>
<li><p><code>lastValidTime</code> - UTC POSIXct time corresponding to the last valid pm25 datum</p></li>
<li><p><code>lastValidLocalTimestamp</code> - ASCII version of <code>lastValidTime</code> in monitor-local timezone</p></li>
<li><p><code>processingTime</code> - UTC POSIXct when the function is run (<em>i.e.</em> 'now')</p></li>
<li><p><code>datetime</code> - UTC POSIXct of the datetime that the data represents. See <code>datetime</code> parameter. In most instances, the same as <code>processingTime</code></p></li>
<li><p><code>latency</code> - (difference between processingTime -1 hr) and lastValidTime, floored to the hour</p></li>
<li><p><code>lastValid_PM2.5_nowcast</code> - NowCast value at lastValidTime</p></li>
<li><p><code>lastValid_PM2.5_1hr</code> - PM2.5 value at lastValidTime (should never be null)</p></li>
<li><p><code>lastValid_PM2.5_3hr</code> - mean of the three hours preceeding lastValidTime</p></li>
<li><p><code>yesterday_PM2.5_24hr</code> - local time midnight-to-midnight 24-hour mean for the day prior to processingTime</p></li>
<li><p><code>monitoringSiteUrl</code> - URL to PWFSL Monitoring v4 site, initialized with a specific monitor</p></li>
</ul><p>The three-hour average will remove missing values and may represent an average of 1-3 hours.</p>
<p>The yesterday average will remove up to six missing values, returning <code>NA</code> if more than six hours of yesterday's data are missing.</p>
<p>Any monitors with no data from before the desired datetime will be excluded.</p>
<p><strong>NOTE:</strong> <code>yesterday_PM2.5_24hr</code> represents yesterday relative to <code>datetime</code> -- <em>i.e.</em> actually yesterday.
The various 'lastValid' values describe the most recent valid values -- before <code>datetime</code>, whenever they occurred.</p>
    
    </div>

    <pre class="usage"><span class='fu'>monitor_currentData</span>(<span class='no'>ws_monitor</span>, <span class='kw'>datetime</span> <span class='kw'>=</span> <span class='kw pkg'>lubridate</span><span class='kw ns'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/now.html'>now</a></span>(<span class='st'>"UTC"</span>),
  <span class='kw'>monitoringUrlBase</span> <span class='kw'>=</span> <span class='st'>"http://tools.airfire.org/monitoring/v4/#!/?monitors="</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ws_monitor</th>
      <td><p><em>ws_monitor</em> object</p></td>
    </tr>
    <tr>
      <th>datetime</th>
      <td><p>Time to which data will be 'current' (integer or character representing YYYYMMDDHH or <code>POSIXct</code>.
If not <code>POSIXct</code>, interpreted as UTC time).
So if <code>datetime</code> is 3 hours ago, a dataframe with the most current data from 3 hours ago will be returned.</p></td>
    </tr>
    <tr>
      <th>monitoringUrlBase</th>
      <td><p>base URL for constructing a link to the PWFSL Smoke Monitoring site</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A tibble of "lastValid" data and associated timing information.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Data are assigned to the beginning of the hour they represent. So a PM2.5 value assigned to 2pm
will represent data averaged over the period 14:00 - 14:59. This is in keeping with a day representing
00:00 - 23:59 and a month representing the beginning of the month until the end of the month.</p>
<p>Because of this, data for 2pm should never be available until just after 3pm. If it is currently 3:15pm
then we need to subtract 1 hour from the current <code>processingTime</code> before subtracting the <code>lastValidTime</code>
to generate the <code>latency</code>.</p>
<p>The parameter <code>datetime</code> is meant to simulate current data at a time different from the current time. Therefore, when <code>datetime</code>
is specified, the returned dataframe will represent data up to an hour before <code>datetime</code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='no'>wa</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='loadLatest.html'>loadLatest</a></span>() <span class='kw'>%&gt;%</span> <span class='fu'><a href='monitor_subset.html'>monitor_subset</a></span>(<span class='kw'>stateCodes</span> <span class='kw'>=</span> <span class='st'>'WA'</span>)
<span class='no'>wa_current</span> <span class='kw'>&lt;-</span> <span class='fu'>monitor_currentData</span>(<span class='no'>wa</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jonathan Callahan, Rohan Aras, Zach Dingels, Jon Hagg, Jimin Kim, Helen Miller, Spencer Pease, Rex Thompson, Alice Yang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

